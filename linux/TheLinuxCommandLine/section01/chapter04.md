# 第四章: 操作文件与目录 #

本章将介绍以下命令:

- cp: 复制文件与目录
- mv: 移动或重命名文件和目录
- mkdir: 创建目录
- rm: 删除文件和目录
- in: 创建硬链接和符号链接

## 4.1 通配符 ##

shell提供了一些特殊字符来帮助你快速指定一组文件名, 这些特殊字符称为通配符. 通配符的描述如下表:

| 通配符 | 匹配项 |
|:--|:--|
| * | 匹配任意多个字符, 包括0个和1个 |
| ? | 匹配任一单个字符 |
| [characters] | 匹配任意一个属于字符集中的字符 |
| [!characters] | 匹配任意一个不属于字符集中的字符 |
| [[:class:]] | 匹配任意一个属于指定字符类的字符 |

下表列出了常用的字符类:

| 字符类 | 匹配项 |
|:--|:--|
| [:alnum:] | 匹配任意一个字母或数字 |
| [:alpha:] | 匹配任意一个字母 |
| [:digit:] | 匹配任意一个数字 |
| [:lower:] | 匹配任意一个小写字母 |
| [:upper:] | 匹配任意一个大写字母 |

下表列出了一些示例:

| 模式 | 匹配项 |
|:--|:--|
| * | 所有文件 |
| g* | 以g开头的文件 |
| Data??? | 以Data开头, 后面跟3个字符的任一文件 |
| [abc]* | 以abc任意一个开头的任一文件 |
| BACKUP.[0-9][0-9][0-9] | 以BACKUP. 开头, 后面紧跟三个数字的任一文件 |
| *[[:lower:]123] | 以小写字母或者1,2,3中任意一个结尾的文件 |

## 4.2 mkdir-创建目录 ##

格式如下:

```
mkdir directory...         # ...表示可接多个参数
```

## 4.3 cp-复制文件和目录 ##

cp文件用来复制文件和目录, 有两种形式:

```
cp item1 item2     # 复制文件或目录item1到文件或目录item2中
cp item... directory      # 将多个项目复制进目录
```

cp常用的选项如下:

| 短选项 | 长选项 | 含义 |
|:--:|:--|:--|
| -a | --archive | 复制文件和目录及其属性, 包括所有权和权限. 通常复制的文件具有用户操作文件的默认属性 |
| -i | --interactive | 覆盖文件前提示用户进行确认 |
| -r | --recursive | 递归的复制目录及其内容 |
| -u | --update | 只复制那些目标目录中不存在的文件或是目标目录相应文件的更新文件 |
| -v | --verbose | 复制文件时显示信息性消息 |

## 4.4 mv-移动和重命名文件 ##

mv命令可以执行文件移动和文件重命名操作, 使用方法和cp基本相似.

```
mv item1 item2              # 移动或重命名文件和目录
mv item... directory        # 移动item到目录
```

mv命令的很多选项是和cp命令共享的, 如下表:

| 短选项 | 长选项 | 含义 |
|:--:|:--|:--|
| -i | --interactive | 覆盖文件前提示用户进行确认 |
| -u | --update | 只移动那些目标目录中不存在的文件或是目标目录相应文件的更新文件 |
| -v | --verbose | 移动文件时显示信息性消息 |

## 4.5 rm-删除文件和目录 ##

rm用来删除文件和目录.

```
rm item...
```

下表列出了一些常用的选项:

| 短选项 | 长选项 | 含义 |
|:--:|:--|:--|
| -i | --interactive | 删除文件前提示用户进行确认 |
| -r | --recursive | 递归的删除目录及其内容 |
| -f | --force | 忽略不存在的文件并无需提示确认, 该选项会覆盖 -i选项|
| -v | --verbose | 删除文件时显示信息性消息 |

## 4.6 ln-创建链接 ##

ln命令用来创建硬链接或是符号链接, 使用方式有以下几种:

```
ln file link                 # 创建硬链接
ln -s item link              # 创建软链接
```

硬链接只能是文件, 软链接可以是文件或目录.

### 4.6.1 硬链接 ###

硬链接是最初UNIX用来创建链接的方式, 默认情况下每个文件有一个硬链接, 该硬链接会给文件起名字. 当创建一个硬链接的时候也为这个文件创建了一个额外的目录条目. 硬链接有两条重要的局限性:

- 硬链接不能引用自身文件系统之外的文件, 即不在同一个磁盘分区的文件
- 硬链接无法引用目录

硬链接和文件本身没有区别, 包含了硬链接的目录列表没有特别的链接指示说明, 当硬链接被删除时只是删除了这个链接, 文件本身的内容依然存在.

可以想象文件是由两个部分组成的, 包含文件内容的数据部分和包含文件名的名称部分. 创建硬链接时, 实际上是创建了额外的名称, 这些名称都指向同一数据部分. 系统分配了一系列的盘块给所谓的索引节点(inode), 该节点随后与文件名称部分建立关联. 因此每个硬链接都指向包含文件内容的具体索引节点.

### 4.6.2 符号链接 ###

符号链接是通过创建一个特殊类型的文件来起作用的, 该文件包含了指向引用文件或目录的文本指针. 符号链接与Windows系统下的快捷方式非常相似.

创建符号链接时, 同时也创建一个文本来描述目标文件在哪里. 在创建符号连接时, 可以使用绝对路径名以及相对路径名, 相对路径名允许包含符号链接的目录被重命名或移动, 而且不会破坏链接, 因此更为可取.
